<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<style>
			html, body {
			margin: 0;
			padding: 0;
			border: 0;
			}

			* {
			box-sizing: border-box;
			}

			input:focus {
				outline: none;
			}
			#element::-webkit-scrollbar {
			  width: 10px;
			}

			#element::-webkit-scrollbar-thumb {
			  background-color: #fcd76a;
			}
			#element::-webkit-scrollbar-track {
  			  background-color: #faecc5;
			}

		</style>
	</head>
	<body style="text-align: center;">
		<header id="bar_search" style="display: flex; align-items: center; height: fit-content; width: 100%; background-color: #806950; color: #fae7b4; padding: 0.2% 1%; border: 2px solid #756537; border-radius: 10px; position: fixed; z-index: 1;">
			<div style="margin-right: auto;">
				<div style="font-family: Arial, sans-serif; font-size: 30px; padding: 5px 5px;">DotaAnalytics</div>
				<div id="bar_auth" style="display: flex; flex-direction: row; justify-content: center;">
					<button onclick="sign_up()" id="sign_up" style="background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">sign up</button>
					<button onclick="log_in()" id="log_in" style="margin-left: 10px; background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">log in</button>
				</div>
			</div>

			<div id="bar_match" style="display: flex; justify-content: flex-end; padding: 0% 1%;">
				<button id="button_match" onclick="click_button_match()" style="background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 10px 10px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 5px 5px 5px 5px; white-space: nowrap;">Поиск матча по id</button>
				<input id="input_match" type="text" style="display: none; width: 100%; background-color: #fae7b4; color: #66533f; border: 2px solid #756537; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold;">
				<button id="icon_match" onclick="search_for_match_by_matchid()" style="display: none; padding: 10px 15px; font-size: 16px; background-image: url({{ url_for('static', filename='image.bmp') }}); background-size: 100% 100%; color: #fae7b4; border: 2px solid #756537; border-left: none; border-radius: 0px 5px 5px 0px;">0</button>
			</div>

			<div id="bar_player" style="display: flex; justify-content: flex-end; padding: 0% 1%;">
				<button id="button_player" onclick="click_button_player()" style="background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 10px 10px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 5px 5px 5px 5px; white-space: nowrap;">Поиск игроков</button>
				<input id="input_player" type="text" style="display: none; width: 100%; background-color: #fae7b4; color: #66533f; border: 2px solid #756537; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold;">
				<button id="icon_player" onclick="search_for_steamid_by_nickname()" style="display: none; padding: 10px 15px; font-size: 16px; background-image: url({{ url_for('static', filename='image.bmp') }}); background-size: 100% 100%; color: #fae7b4; border: 2px solid #756537; border-left: none; border-radius: 0px 5px 5px 0px;">0</button>
			</div>
		</header>
		<main id="block_results" style="background-color: #fae7b4; display: inline-block; padding: 9px; border-radius: 9px; border: 2px solid #756537;">
		</main>
		<script>
			let animation = false;

			let bar_auth = document.getElementById("bar_auth");
			let bar_auth_default = '<button onclick="sign_up()" id="sign_up" style="background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">sign up</button><button onclick="log_in()" id="log_in" style="margin-left: 10px; background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">log in</button>';

			let results = document.getElementById("block_results");

			let bar_search = document.getElementById("bar_search");

			let bar_match = document.getElementById("bar_match");
			let button_match = document.getElementById("button_match");
			let input_match = document.getElementById("input_match");
			let icon_match = document.getElementById("icon_match");

			let bar_player = document.getElementById("bar_player");
			let button_player = document.getElementById("button_player");
			let input_player = document.getElementById("input_player");
			let icon_player = document.getElementById("icon_player");

			function add_player(player) {
				try {
					var cookieValue = decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)myCookie\s*\=\s*([^;]*).*$)|^.*$/, "$1"));
					var jsonData = JSON.parse(cookieValue);
					if ("token" in jsonData) {
						fetch('/add_player', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json'
							},
							body: JSON.stringify({
								steam_id: player,
								token: jsonData['token']
							})
						})
					}
				} catch (e) {
					;
				}
			}

			function add_match(match) {
				try {
					var cookieValue = decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)myCookie\s*\=\s*([^;]*).*$)|^.*$/, "$1"));
					var jsonData = JSON.parse(cookieValue);
					if ("token" in jsonData) {
						fetch('/add_match', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json'
							},
							body: JSON.stringify({
								match_id: match,
								token: jsonData['token']
							})
						})
					}
				} catch (e) {
					;
				}
			}

			function formatTime(seconds) {
					   var hours = Math.floor(seconds / 3600);
					   var minutes = Math.floor((seconds - (hours * 3600)) / 60);
					   var remainingSeconds = seconds - (hours * 3600) - (minutes * 60);
					   var timeString = '';
					   if (hours > 0) {
 					      timeString += (hours < 10) ? "0" + hours + ":" : hours + ":";
					   }
					   timeString += (minutes < 10) ? "0" + minutes + ":" : minutes + ":";
					   timeString += (remainingSeconds < 10) ? "0" + remainingSeconds : remainingSeconds;
					   return timeString;
					}

			async function one_player(steam_id) {
				add_player(steam_id)
				results.style['margin-top'] = (bar_search.scrollHeight) + 'px';
				results.innerHTML = '';

				var response = await fetch("https://api.opendota.com/api/players/" + steam_id);
				var data = await response.json();

				if (Object.keys(data).length == "5") {
					var icon_and_profile = document.createElement("div");
					icon_and_profile.style = 'font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; margin-top: 7px; display: flex; justify-content: space-between; align-items: center;';
					icon_and_profile.innerHTML = 'Челик не играет в доту(((';
					results.appendChild(icon_and_profile);
				} else {
					var response_region = await fetch("https://api.opendota.com/api/constants/region");
					var data_region = await response_region.json()
					var response_counts = await fetch("https://api.opendota.com/api/players/" + steam_id + "/counts");
					var data_counts = await response_counts.json();
					data_counts = data_counts["region"];
					var maxGames = 0;
					var maxGamesKey = null;
					for (var key in data_counts) {
					  if (data_counts.hasOwnProperty(key)) {
						let value = data_counts[key].games;
						if (value > maxGames) {
						  maxGames = value;
						  maxGamesKey = key;
						}
					  }
					}
					var region = data_region[maxGamesKey]

					var response_game_mode = await fetch("https://api.opendota.com/api/constants/game_mode");
					var data_game_mode = await response_game_mode.json();
					var response_counts = await fetch("https://api.opendota.com/api/players/" + steam_id + "/counts");
					var data_counts = await response_counts.json();
					data_counts = data_counts["game_mode"];
					var maxGames = 0;
					var maxGamesKey = null;
					for (var key in data_counts) {
					  if (data_counts.hasOwnProperty(key)) {
						let value = data_counts[key].games;
						if (value > maxGames) {
						  maxGames = value;
						  maxGamesKey = key;
						}
					  }
					}
					var game_mode = data_game_mode[maxGamesKey]

					var response_wl = await fetch("https://api.opendota.com/api/players/" + steam_id + "/wl");
					var data_wl = await response_wl.json();

					var mmr_estimate = data["mmr_estimate"]["estimate"];

					var rank_tier = data["rank_tier"];

					var is_subscriber = data["profile"]["is_subscriber"];

					var icon_and_profile = document.createElement("div");
					icon_and_profile.style = 'font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; margin-top: 7px; display: flex; align-items: center; width: 1000px; text-align: center; justify-content: center;';
					icon_and_profile.innerHTML = `<img src="${data['profile']['avatarfull']}" alt="alt" style="padding: 15px; width: 110px; height: 110px; text-align: center;"><div style="padding: 15px; text-align: center; font-family: Arial, sans-serif; font-size: 43px; color: #544535; border: none;">${data['profile']['personaname']}</div>`;

					var about = document.createElement("div");
					about.style = "display: flex; flex-direction: row;";
					about.innerHTML = `<div style="width: 33%; height: 60px;">` +
									  	  `<div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${region}</div>` +
									      `<div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Часто выбираймый регион</div>` +
									  `</div>` +
									  `<div style="width: 33%; height: 60px;">` +
									      `<div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${game_mode["name"].substring(10)}</div>` +
									      `<div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Часто выбираймый игровой режим</div>` +
									  `</div>` +
									  `<div style="width: 33%; height: 60px;">` +
										  `<div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">` +
											  `<span style="color: #79d43d; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
												  `${data_wl["win"]}` +
											  `</span>` +
											  `:` +
											  `<span style="color: red; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
												  `${data_wl["lose"]}` +
											  `</span>` +
											  ` | ` +
											  `<span style="color: #38fff8; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
												  `${(data_wl["win"] / (data_wl["win"] + data_wl["lose"]) * 100).toFixed(1)}` + `%` +
											  `</span>` +
										  `</div>` +
									      `<div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Победы и поражения</div>` +
									  `</div>`;

					var about2 = document.createElement("div");
					about2.style = "display: flex; flex-direction: row;";
					about2.innerHTML = `<div style="width: 33%; height: 60px;">` +
									  	  `<div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${mmr_estimate}</div>` +
									      `<div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Оценочный рейтинг</div>` +
									  `</div>` +
									  `<div style="width: 33%; height: 60px;">` +
									      `<div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${rank_tier}</div>` +
									      `<div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Уровень ранга</div>` +
									  `</div>` +
									  `<div style="width: 33%; height: 60px;">` +
										  `<div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${is_subscriber}</div>` +
									      `<div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Dota plus</div>` +
									  `</div>`;

					var val3;
					async function for_await() {
						var response_matchs = await fetch(`https://api.opendota.com/api/players/${steam_id}/matches`);
						var data_matchs = await response_matchs.json();

						var dota_heroes = await fetch("https://api.opendota.com/api/heroes");
						var dota_heroes = await dota_heroes.json();
						var val_4;

						var label_match = document.createElement("div");
						label_match.style = 'font-family: Arial, sans-serif; font-size: 24px; color: rgb(250, 231, 180); margin-top: 7px; display: flex; align-items: center; width: 1000px; text-align: center; justify-content: center;';
						label_match.innerHTML = '<div style="padding: 15px; text-align: center; font-family: Arial, sans-serif; font-size: 43px; color: #544535; border: none;">Матчи</div>';
						results.append(label_match);

						for (val3 of data_matchs) {

							for (val_4 of dota_heroes) {
								if (val_4['id'] == val3['hero_id']) {
									val_4 = val_4['name'].substring(14);
									val_4 = 'https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/heroes/' + val_4 + '.png';
									break;
								}
							}

							var match = document.createElement("button");
							match.style = "background-color: rgb(128, 105, 80); border: 5px solid rgb(102, 83, 63); border-radius: 9px; font-family: Arial, sans-serif; font-size: 24px; color: rgb(250, 231, 180); margin-top: 7px; display: flex; justify-content: center; align-items: center; margin-left: auto; margin-right: auto;";
							var onClickHandler = function(match_id) {
								return function() {
									input_match.value = match_id;
									search_for_match_by_matchid();
									};
							};
							match.onclick = onClickHandler(val3["match_id"]);

							var match_id = document.createElement("img");
							match_id.style = "padding: 8px; width: 142px; height: 80px;";
							match_id.src = val_4;
							var brief_information = document.createElement("div");
							brief_information.innerHTML = `<div style="width: 100%; height: 30px; color: rgb(128, 105, 80); font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; line-height: 30px; color: rgb(250, 231, 180);">id матча: ${val3["match_id"]}</div>` +
														  `<div style="display: flex; flex-direction: row; width: 270px; height: 30px;">` +
															  `<div style="width: 130px; height: 30px; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
																  `<span style="color: #79d43d; font-family: Arial, sans-serif; font-size: 25px; text-align: center; line-height: 30px;">` +
																	  `${val3['kills']}` +
																  `</span>` +
																  `:` +
																  `<span style="color: #f56262; font-family: Arial, sans-serif; font-size: 25px; text-align: center; line-height: 30px;">` +
																	  `${val3['deaths']}` +
																  `</span>` +
																  `:` +
																  `<span style="color: grey; font-family: Arial, sans-serif; font-size: 25px; text-align: center; line-height: 30px;">` +
																	  `${val3['assists']}` +
																  `</span>` +
															  `</div>` +
															  `<div style="width: 130px; height: 30px; color: ${(val3['player_slot'] < 64) == val3['radiant_win'] ? '#1ff707' : '#f56262'}; font-family: Arial, sans-serif; font-size: 25px; text-align: center; line-height: 30px;">` +
																`${(val3['player_slot'] < 64) == val3['radiant_win'] ? 'Победа' : 'Поражение'}` +
															  `</div>` +
														  `</div>`;

							match.appendChild(match_id);
							match.appendChild(brief_information);

							results.appendChild(match);
						}
					}
					for_await()
					results.appendChild(icon_and_profile);
					results.appendChild(about);
					results.appendChild(about2);
				}
			}


			function log_in() {
				results.style['margin-top'] = (bar_search.scrollHeight) + 'px';
				results.innerHTML = '';

				var button_ = document.createElement("button");
				button_.style = "margin-top: 15px; margin-bottom: 15px; text-align: center; background-color: #806950; color: #fae7b4; padding: 14px 14px; font-family: Arial, sans-serif; font-size: 23px; font-weight: bold; border-radius: 5px 5px 5px 5px;";
				button_.innerHTML = "Войти";
				button_.onclick = function() {
					var username1 = document.getElementById("username").value;
					var password1 = document.getElementById("password_1").value;

					var short_name = document.getElementById("short_name");
					var short_password = document.getElementById("short_password");
					var error = document.getElementById("error");

					short_name.style["display"] = "none";
					short_password.style["display"] = "none";
					error.style["display"] = "none";

					if (username1.length < 4) {
						short_name.style["display"] = "block";
				  	} else if (password1.length < 6) {
				  		short_password.style["display"] = "block";
				  	} else {
				  		fetch('/log_in', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json'
							},
							body: JSON.stringify({
								username: username1,
								password: password1
							})
						})
						.then(response => response.json())
						.then(data => {
							if ("error" in data) {
								error.style["display"] = "block";
							} else {
								header_2.innerHTML = '<div style="text-align: center; background-color: #fae7b4; color: green; padding: 20px 20px; font-family: Arial, sans-serif; font-size: 40px; font-weight: bold;">Вы успешно авторизированы</div>';
								var jsonString = JSON.stringify(data);
								var encodedJsonString = encodeURIComponent(jsonString);
								var expirationDate = new Date();
								expirationDate.setDate(expirationDate.getDate() + 30);
								document.cookie = "myCookie=" + encodedJsonString + "; expires=" + expirationDate.toUTCString() + "; path=/";

								var cookieValue = decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)myCookie\s*\=\s*([^;]*).*$)|^.*$/, "$1"));
								var jsonData = JSON.parse(cookieValue);

								bar_auth.innerHTML = '';

								var button_for_bar_auth = document.createElement("button");
								button_for_bar_auth.style = "background-color: #806950; color: white; padding: 2px 4px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border: 2px solid white; border-radius: 5px 5px 5px 5px;";
								button_for_bar_auth.innerHTML = jsonData["username"];
								button_for_bar_auth.onclick = function() {
									results.innerHTML = "";
									var cookieValue = decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)myCookie\s*\=\s*([^;]*).*$)|^.*$/, "$1"));
									var jsonData = JSON.parse(cookieValue);
									fetch('/profil', {
										method: 'POST',
										headers: {
											'Content-Type': 'application/json'
										},
										body: JSON.stringify({
											token: jsonData['token'],
										})
									})
									.then(response => response.json())
									.then(data => {
										if ("error" in data) {
											results.innerHTML = '<div style="text-align: center; background-color: #fae7b4; color: red; padding: 20px 20px; font-family: Arial, sans-serif; font-size: 40px; font-weight: bold;">Произошла ошибка</div>';
											bar_auth.innerHTML = '<button onclick="sign_up()" id="sign_up" style="background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">sign up</button><button onclick="log_in()" id="log_in" style="margin-left: 10px; background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">log in</button>';
										} else {
											var username = document.createElement("div");
											username.style = "font-family: Arial, sans-serif; font-size: 30px; padding: 11px 11px; color: #806950; margin-left: 20px; margin-top: 20px; text-align: left;";
											username.innerHTML = 'Имя аккаунта: '+ data['profil']['username'];

											var created_date = document.createElement("div");
											created_date.style = "font-family: Arial, sans-serif; font-size: 30px; padding: 11px 11px; color: #806950; margin-left: 20px; margin-top: 10px; text-align: left;";
											created_date.innerHTML = 'Дата регистрации: ' + data['profil']['created_date'];

											var exit = document.createElement("button");
											exit.style = "font-family: Arial, sans-serif; font-size: 30px; padding: 11px 11px; color: #fae7b4; margin-left: auto; text-align: left; border-radius: 6px 6px 6px 6px; background-color: #806950;";
											exit.innerHTML = 'Выйти с аккаунта';
											exit.onclick = function() {
												results.innerHTML = "";
												bar_auth.innerHTML = '<button onclick="sign_up()" id="sign_up" style="background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">sign up</button><button onclick="log_in()" id="log_in" style="margin-left: 10px; background-color: #fae7b4; color: #806950; border: 2px solid #756537; padding: 6px 6px; font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; border-radius: 4px 4px 4px 4px; white-space: nowrap;">log in</button>';
												fetch('/delete_session', {
													method: 'POST',
													headers: {
														'Content-Type': 'application/json'
													},
													body: JSON.stringify({
														token: jsonData['token'],
													})
												})
												.then(response => response.json())
												.then(data => {if ("success" in data) {
													document.cookie = "token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
												}})
											};

											var bar_viewed = document.createElement("div");
											bar_viewed.style = 'display: flex; flex-direction: row; ';

											var matchs_viewed = document.createElement("div");

											var title = document.createElement("div");
											title.style = "text-align: center; color: #544535; padding: 10px 20px; font-family: Arial, sans-serif; font-size: 30px; border-bottom: 2px solid #544535;";
											title.innerHTML = "Просмотренные матчи";
											matchs_viewed.appendChild(title);

											var val3;
											async function for_await() {
											  for (val3 of data['matchs']) {
												var response = await fetch("https://api.opendota.com/api/matches/" + val3["match_id"]);
												var data_ = await response.json();
												console.log(data_);

												var onClickHandler = function(match_id) {
												  return function() {
													input_match.value = match_id;
													search_for_match_by_matchid();
												  };
												};

												var match = document.createElement("button");
												match.style = "background-color: rgb(128, 105, 80); border: 5px solid rgb(102, 83, 63); border-radius: 9px; font-family: Arial, sans-serif; font-size: 24px; color: rgb(250, 231, 180); margin-top: 7px; display: flex; justify-content: space-between; align-items: center; width: 100%;";

												match.onclick = onClickHandler(val3["match_id"]);

												var match_id = document.createElement("div");
												match_id.style = "padding: 15px; text-align: center; font-family: Arial, sans-serif; font-size: 24px; color: rgb(250, 231, 180);";
												match_id.innerHTML = val3['match_id'];

												var brief_information = document.createElement("div");
												brief_information.innerHTML = `<div style="width: 100%; height: 30px; color: rgb(128, 105, 80); font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; text-align: center; line-height: 30px; color: ${data_['radiant_win'] ? '#1ff707' : '#f56262'};">${data['radiant_win'] ? 'radiant win' : 'dire win'}</div>` +
												  `<div style="display: flex; flex-direction: row; width: 270px; height: 30px;">` +
												  `<div style="width: 130px; height: 30px; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
												  `<span style="color: #79d43d; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
												  `${data_['radiant_score']}` +
												  `</span>` +
												  `:` +
												  `<span style="color: red; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
												  `${data_['dire_score']}` +
												  `</span>` +
												  `</div>` +
												  `<div style="width: 130px; height: 30px; color: rgb(250, 231, 180); font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">` +
												  `${formatTime(data_['duration'])}` +
																					  `</div>` +
																				  `</div>`;

													match.appendChild(match_id);
													match.appendChild(brief_information);

													matchs_viewed.appendChild(match);
												}
											}
											for_await()

											var players_viewed = document.createElement("div");

											var title = document.createElement("div");
											title.style = "text-align: center; color: #544535; padding: 10px 20px; font-family: Arial, sans-serif; font-size: 30px; border-bottom: 2px solid #544535;";
											title.innerHTML = "Просмотренные профили";
											players_viewed.appendChild(title);

											var val3;
											async function for_await_2() {
												for (val3 of data['players']) {
													var response = await fetch("https://api.opendota.com/api/players/" + val3["steam_id"]);
													var data_ = await response.json();

													var item = document.createElement("div");
												    item.style = 'background-color: #806950; border: 5px solid #66533f; border-radius: 9px; font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; margin-top: 7px; display: flex; justify-content: space-between; align-items: center;';
												    console.log(data_);
												    item.innerHTML = `<img src="${data_["profile"]["avatarfull"]}" alt="alt" style="padding: 15px; width: 110px; height: 110px; text-align: center;"><button onclick="one_player('${val3['steam_id']}')" style="padding: 15px; text-align: center; margin-left: auto; margin-right: auto; background-color: #806950; font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; border: none;">${data_["profile"]["personaname"]}</button>`;

												    players_viewed.appendChild(item);
												}
											}
											for_await_2()

											var plugn = document.createElement("div");
											plugn.style = "width: 2px; height: 100%; padding: 3px 0px; background-color: #544535;";

											bar_viewed.appendChild(matchs_viewed);
											bar_viewed.appendChild(plugn);
											bar_viewed.appendChild(players_viewed);

											results.appendChild(username);
											results.appendChild(created_date);
											results.appendChild(exit);
											results.appendChild(bar_viewed);
										}
									});

									var username = document.createElement("div");
									username.style = "text-align: center; background-color: #fae7b4; color: #806950; padding: 20px 20px; font-family: Arial, sans-serif; font-size: 40px; font-weight: bold;";
									username.innerHTML = "";
								};
								bar_auth.appendChild(button_for_bar_auth);
							}
						});
				  	}
				};


				var header_2 = document.createElement("div");
				header_2.innerHTML = '<div style="text-align: center; background-color: #fae7b4; color: #806950; padding: 20px 20px; font-family: Arial, sans-serif; font-size: 40px; font-weight: bold;">Авторизация</div>' +
									 '<div style="display: flex; flex-direction: row; padding: 20px 10px;"><div style="text-align: center; background-color: #fae7b4; color: #806950; padding: 7px 7px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border-radius: 5px 0px 0px 5px;">Имя пользователя</div><input maxlength="32" type="text" id="username" style="background-color: #806950; color: #fae7b4; padding: 7px 13px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border-radius: 5px 5px 5px 5px;"></div>' +
									 '<div style="display: flex; flex-direction: row; padding: 20px 10px;"><div style="text-align: center; background-color: #fae7b4; color: #806950; padding: 7px 7px; border-radius: 5px 0px 0px 5px;"><pre style="display: inline; margin: 0; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold;">Пароль                    </pre></div><input maxlength="32" id="password_1" type="password" style="background-color: #806950; color: #fae7b4; padding: 7px 13px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border-radius: 5px 5px 5px 5px;"></div>' +
									 '<div id="short_name" style="display: none; color: red; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; width: 100%; margin-top: 10px; margin-bottom: 10px;">Минимальная длина имени - 4 символа</div>' +
									 '<div id="short_password" style="display: none; color: red; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; width: 100%; margin-top: 10px; margin-bottom: 10px;">Минимальная длина пароля - 6 символа</div>' +
									 '<div id="error" style="display: none; color: red; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; width: 100%; margin-top: 10px; margin-bottom: 10px;">Пользователь не существует или неверный пароль</div>';

				header_2.appendChild(button_);
				results.appendChild(header_2);
			}


			function sign_up() {
				results.style['margin-top'] = (bar_search.scrollHeight) + 'px';
				results.innerHTML = '';

				var button_ = document.createElement("button");
				button_.style = "margin-top: 15px; margin-bottom: 15px; text-align: center; background-color: #806950; color: #fae7b4; padding: 14px 14px; font-family: Arial, sans-serif; font-size: 23px; font-weight: bold; border-radius: 5px 5px 5px 5px;";
				button_.innerHTML = "зарегистрироваться";
				button_.onclick = function() {
					var username1 = document.getElementById("username").value;
					var password1 = document.getElementById("password_1").value;
					var password2 = document.getElementById("password_2").value;

					var passwords_do_not_match = document.getElementById("passwords_do_not_match");
					var short_name = document.getElementById("short_name");
					var short_password = document.getElementById("short_password");
					var name_taken = document.getElementById("name_taken");

					passwords_do_not_match.style["display"] = "none";
					short_name.style["display"] = "none";
					short_password.style["display"] = "none";
					name_taken.style["display"] = "none";

					if (password1 !== password2) {
						passwords_do_not_match.style["display"] = "block";
					} else if (username1.length < 4) {
						short_name.style["display"] = "block";
				  	} else if (password1.length < 6) {
				  		short_password.style["display"] = "block";
				  	} else {
				  		fetch('/sign_up', {
							method: 'POST',
							headers: {
								'Content-Type': 'application/json'
							},
							body: JSON.stringify({
								username: username1,
								password: password1
							})
						})
						.then(response => response.json())
						.then(data => {
							if ("error" in data) {
								name_taken.style["display"] = "block";
							} else {
								header_2.innerHTML = '<div style="text-align: center; background-color: #fae7b4; color: green; padding: 20px 20px; font-family: Arial, sans-serif; font-size: 40px; font-weight: bold;">Вы успешно зарегистрировались</div>';
							}
						});
				  	}
				};


				var header_2 = document.createElement("div");
				header_2.innerHTML = '<div style="text-align: center; background-color: #fae7b4; color: #806950; padding: 20px 20px; font-family: Arial, sans-serif; font-size: 40px; font-weight: bold;">Регистрация</div>' +
									 '<div style="display: flex; flex-direction: row; padding: 20px 10px;"><div style="text-align: center; background-color: #fae7b4; color: #806950; padding: 7px 7px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border-radius: 5px 0px 0px 5px;">Имя пользователя</div><input maxlength="32" type="text" id="username" style="background-color: #806950; color: #fae7b4; padding: 7px 13px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border-radius: 5px 5px 5px 5px;"></div>' +
									 '<div style="display: flex; flex-direction: row; padding: 20px 10px;"><div style="text-align: center; background-color: #fae7b4; color: #806950; padding: 7px 7px; border-radius: 5px 0px 0px 5px;"><pre style="display: inline; margin: 0; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold;">Пароль                    </pre></div><input maxlength="32" id="password_1" type="password" style="background-color: #806950; color: #fae7b4; padding: 7px 13px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border-radius: 5px 5px 5px 5px;"></div>' +
									 '<div style="display: flex; flex-direction: row; padding: 20px 10px;"><div style="text-align: center; background-color: #fae7b4; color: #806950; padding: 7px 7px; border-radius: 5px 0px 0px 5px;"><pre style="display: inline; margin: 0; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold;">Повторите пароль</pre></div><input type="password" maxlength="32" id="password_2" style="background-color: #806950; color: #fae7b4; padding: 7px 13px; font-family: Arial, sans-serif; font-size: 25px; font-weight: bold; border-radius: 5px 5px 5px 5px;"></div>' +
									 '<div id="passwords_do_not_match" style="display: none; color: red; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; width: 100%; margin-top: 10px; margin-bottom: 10px;">Пароли не совпадают</div>' +
									 '<div id="short_name" style="display: none; color: red; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; width: 100%; margin-top: 10px; margin-bottom: 10px;">Минимальная длина имени - 4 символа</div>' +
									 '<div id="short_password" style="display: none; color: red; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; width: 100%; margin-top: 10px; margin-bottom: 10px;">Минимальная длина пароля - 6 символа</div>' +
									 '<div id="name_taken" style="display: none; color: red; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; width: 100%; margin-top: 10px; margin-bottom: 10px;">Имя занято</div>';

				header_2.appendChild(button_);
				results.appendChild(header_2);
			}

			async function search_for_match_by_matchid() {
				add_match(input_match.value)

				results.style['margin-top'] = (bar_search.scrollHeight) + 'px';
				results.innerHTML = '';

				const url = "https://api.opendota.com/api/matches/" + input_match.value;
				const response = await fetch(url);
				const data = await response.json();

				if ("error" in data) {
					var error = document.createElement("div");
					error.style = 'background-color: #806950; border: 5px solid #66533f; border-radius: 9px; font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; margin-top: 7px; display: flex; justify-content: space-between; align-items: center;';
					error.innerHTML = 'Матч не найден';
					results.append(error);

				} else {
					var results_header = document.createElement("div");
					results_header.style = 'display: flex; flex-direction: row;';

					var team_radiant = new Array();
					var team_dire = new Array();
					var val;

					for (val of data['players']) {
						var player = new Object();
						player['personaname'] = val['personaname'];
						player['hero_id'] = val['hero_id'];
						player['kills'] = val['kills'];
						player['deaths'] = val['deaths'];
						player['assists'] = val['assists'];
						player['net_worth'] = val['net_worth'];
						player['level'] = val['level'];
						player['last_hits'] = val['last_hits'];
						player['denies'] = val['denies'];
						player['hero_damage'] = val['hero_damage'];
						player['hero_healing'] = val['hero_healing'];
						player['tower_healing'] = val['tower_damage'];
						player['permanent_buffs'] = val['permanent_buffs'];
						player['item_0'] = val['item_0'];
						player['item_1'] = val['item_1'];
						player['item_2'] = val['item_2'];
						player['item_3'] = val['item_3'];
						player['item_4'] = val['item_4'];
						player['item_5'] = val['item_5'];
						player['item_neutral'] = val['item_neutral'];
						player['xp_per_min'] = val['xp_per_min'];
						player['gold_per_min'] = val['gold_per_min'];
						player['leaver_status'] = val['leaver_status'];
						player['ability_upgrades_arr'] = val['ability_upgrades_arr'];
						player['is_subscriber'] = val['is_subscriber'];


						if (val['isRadiant']) {
							team_radiant.push(player);
						} else {
							team_dire.push(player);
						}
					}
					var dota_heroes = await fetch("https://api.opendota.com/api/heroes");
					var dota_heroes = await dota_heroes.json();

					var players_radiant = document.createElement('div');

					var names = document.createElement('div');
					names.style = 'display: flex; flex-direction: row; font-family: Arial, sans-serif; font-size: 18px; color: #806950;';
					names.innerHTML = '<div style="height: 45px; width: 80px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + '</div>' +
									  '<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #79d43d; font-weight: 500;">' + 'Имя' +'</div>' +
									  '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'у' + '</div>' +
									  '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'с' + '</div>' +
									  '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'п' + '</div>' +
									  '<div style="height: 45px; width: 75px; color: #d9d921; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'цен' + '</div>' +
									  '<div style="height: 45px; width: 39px; color: #008080; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;	">' + 'ур' + '</div>';
					players_radiant.appendChild(names);

					for (val of team_radiant) {
						var player_radiant = document.createElement('div');

						var val_2;
						for (val_2 of dota_heroes) {
							if (val_2['id'] == val['hero_id']) {
							val_2 = val_2['name'].substring(14);
							val_2 = 'https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/heroes/' + val_2 + '.png';
							break;
							}
						}

						player_radiant.style = 'display: flex; flex-direction: row; font-family: Arial, sans-serif; font-size: 18px; color: #806950;';
						player_radiant.innerHTML = `<div style="height: 45px; width: 80px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; background-image: url('${val_2}'); background-size: 100% 100%;">` + '</div>' +
												   '<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #79d43d; font-weight: 500; font-size: 20px;">' + val['personaname'] + '</div>' +
												   '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['kills'] + '</div>' +
												   '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['deaths'] + '</div>' +
												   '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['assists'] + '</div>' +
												   '<div style="height: 45px; width: 75px; color: #d9d921; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['net_worth'] + '</div>' +
												   '<div style="height: 45px; width: 39px; color: #008080; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;	">' + val['level'] + '</div>';
						players_radiant.appendChild(player_radiant);
					}

					var players_dire = document.createElement('div');

					var names = document.createElement('div');
					names.style = 'display: flex; flex-direction: row; font-family: Arial, sans-serif; font-size: 18px; color: #806950;';
					names.innerHTML = '<div style="height: 45px; width: 39px; color: #008080; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'ур' + '</div>' +
											'<div style="height: 45px; width: 75px; color: #d9d921; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'цен' + '</div>' +
											'<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'у' + '</div>' +
											'<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'с' + '</div>' +
											'<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + 'п' + '</div>' +
											'<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #FF0000; font-weight: 500; font-size: 20px;">' + 'имя' + '</div>' +
											'<div style="height: 45px; width: 85px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + '</div>';
					players_dire.appendChild(names);

					for (val of team_dire) {
						var player_dire = document.createElement('div');

						var val_2;
						for (val_2 of dota_heroes) {
							if (val_2['id'] == val['hero_id']) {
							val_2 = val_2['name'].substring(14);
							val_2 = 'https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/heroes/' + val_2 + '.png';
							break;
							}
						}

						player_dire.style = 'display: flex; flex-direction: row; font-family: Arial, sans-serif; font-size: 18px; color: #806950;';
						player_dire.innerHTML =    '<div style="height: 45px; width: 39px; color: #008080; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;	">' + val['level'] + '</div>' +
												   '<div style="height: 45px; width: 75px; color: #d9d921; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['net_worth'] + '</div>' +
												   '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['kills'] + '</div>' +
												   '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['deaths'] + '</div>' +
												   '<div style="height: 45px; width: 39px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f;">' + val['assists'] + '</div>' +
												   '<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #FF0000; font-weight: 500; font-size: 20px;">' + val['personaname'] + '</div>' +
												   `<div style="height: 45px; width: 80px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; background-image: url('${val_2}'); background-size: 100% 100%;">` + '</div>';
						players_dire.appendChild(player_dire);
					}

					var canvas = document.createElement("canvas");
					canvas.width = 270; canvas.height = 270;
					var context = canvas.getContext("2d");

					var map = new Image(); map.src = "{{ url_for('static', filename='minimap.bmp') }}";
					var tower = new Image(); tower.src = "{{ url_for('static', filename='tower.png') }}";
					var barrack = new Image(); barrack.src = "{{ url_for('static', filename='barrack.png') }}";

					map.onload = function () {
						tower.onload = function () {
							barrack.onload = function () {
								context.drawImage(map, 0, 0, 270, 270);

								var tower_status_dire = data["tower_status_dire"].toString(2).split("").reverse().join("");
								var tower_status_radiant = data["tower_status_radiant"].toString(2).split("").reverse().join("");
								var barracks_status_dire = data["barracks_status_dire"].toString(2).split("").reverse().join("");
								var barracks_status_radiant = data["barracks_status_radiant"].toString(2).split("").reverse().join("");

								var i;
								for (i in tower_status_dire) {
									if (i == "10" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 345 - 10), Math.floor(0.675 * 82 - 10), 20, 20);}
									else if (i == "9" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 329 - 10), Math.floor(0.675 * 64 - 10), 20, 20);}
									else if (i == "8" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 354 - 10), Math.floor(0.675 * 131 - 10), 20, 20);}
									else if (i == "7" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 354 - 10), Math.floor(0.675 * 182 - 10), 20, 20);}
									else if (i == "6" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 354 - 10), Math.floor(0.675 * 242 - 10), 20, 20);}
									else if (i == "5" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 298 - 10), Math.floor(0.675 * 111 - 10), 20, 20);}
									else if (i == "4" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 257 - 10), Math.floor(0.675 * 151 - 10), 20, 20);}
									else if (i == "3" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 213 - 10), Math.floor(0.675 * 183 - 10), 20, 20);}
									else if (i == "2" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 282 - 10), Math.floor(0.675 * 59 - 10), 20, 20);}
									else if (i == "1" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 164 - 10), Math.floor(0.675 * 48 - 10), 20, 20);}
									else if (i == "0" && tower_status_dire[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 85 - 10), Math.floor(0.675 * 52 - 10), 20, 20);}
								}

								for (i in tower_status_radiant) {
									if (i == "10" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 67 - 10), Math.floor(0.675 * 332 - 10), 20, 20);}
									else if (i == "9" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 57 - 10), Math.floor(0.675 * 317 - 10), 20, 20);}
									else if (i == "8" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 109 - 10), Math.floor(0.675 * 345 - 10), 20, 20);}
									else if (i == "7" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 192 - 10), Math.floor(0.675 * 349 - 10), 20, 20);}
									else if (i == "6" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 318 - 10), Math.floor(0.675 * 345 - 10), 20, 20);}
									else if (i == "5" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 89 - 10), Math.floor(0.675 * 297 - 10), 20, 20);}
									else if (i == "4" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 125 - 10), Math.floor(0.675 * 257 - 10), 20, 20);}
									else if (i == "3" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 164 - 10), Math.floor(0.675 * 226 - 10), 20, 20);}
									else if (i == "2" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 38 - 10), Math.floor(0.675 * 277 - 10), 20, 20);}
									else if (i == "1" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 44 - 10), Math.floor(0.675 * 202 - 10), 20, 20);}
									else if (i == "0" && tower_status_radiant[i] == "1") {context.drawImage(tower, Math.floor(0.675 * 44 - 10), Math.floor(0.675 * 154 - 10), 20, 20);}
								}

								for (i in barracks_status_dire) {
									if (i == "5" && barracks_status_dire[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 362 - 6), Math.floor(0.675 * 114 - 6), 13, 13);}
									else if (i == "4" && barracks_status_dire[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 342 - 6), Math.floor(0.675 * 114 - 6), 13, 13);}
									else if (i == "3" && barracks_status_dire[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 317 - 6), Math.floor(0.675 * 111 - 6), 13, 13);}
									else if (i == "2" && barracks_status_dire[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 300 - 6), Math.floor(0.675 * 95 - 6), 13, 13);}
									else if (i == "1" && barracks_status_dire[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 297 - 6), Math.floor(0.675 * 67 - 6), 13, 13);}
									else if (i == "0" && barracks_status_dire[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 297 - 6), Math.floor(0.675 * 44 - 6), 13, 13);}
								}

								for (i in barracks_status_radiant) {
									if (i == "0" && barracks_status_radiant[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 25 - 6), Math.floor(0.675 * 284 - 6), 13, 13);}
									else if (i == "1" && barracks_status_radiant[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 49 - 6), Math.floor(0.675 * 284 - 6), 13, 13);}
									else if (i == "2" && barracks_status_radiant[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 68 - 6), Math.floor(0.675 * 301 - 6), 13, 13);}
									else if (i == "3" && barracks_status_radiant[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 86 - 6), Math.floor(0.675 * 313 - 6), 13, 13);}
									else if (i == "4" && barracks_status_radiant[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 97 - 6), Math.floor(0.675 * 334 - 6), 13, 13);}
									else if (i == "5" && barracks_status_radiant[i] == "1") {context.drawImage(barrack, Math.floor(0.675 * 97 - 6), Math.floor(0.675 * 358 - 6), 13, 13);}
								}
							};
						};
					};

					var dota_items = await fetch("https://api.opendota.com/api/constants/item_ids");
					var dota_items = await dota_items.json();

					var dota_ability = await fetch("https://api.opendota.com/api/constants/ability_ids");
					var dota_ability = await dota_ability.json();

					var dota_ability_description = await fetch("https://api.opendota.com/api/constants/abilities");
					var dota_ability_description = await dota_ability_description.json();

					var details_radiant = document.createElement("div");
					details_radiant.style = "width: 1294px; display: flex; flex-direction: row; border: 1px solid #756537; margin-top: 20px; overflow: auto; background-color: #fadcb4;";
					details_radiant.id = "element";
					var icons_heros = document.createElement("div");
					var plug = document.createElement("div");
					plug.style = "width: 80px; height: 45px; text_align: center; line-height: 45px; font-size: 20px; font-family: Arial, sans-serif; font-weight: bold; color: #79d43d; background-color: #90EE90;";
					plug.innerHTML = "radiant";
					icons_heros.appendChild(plug);
					for (val of team_radiant) {
						var val_2;
						var icon_hero = document.createElement("div");
						for (val_2 of dota_heroes) {
							if (val_2['id'] == val['hero_id']) {
								val_2 = val_2['name'].substring(14);
								val_2 = 'https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/heroes/' + val_2 + '.png';
								icon_hero.style = `width: 80px; height: 45px; background-image: url('${val_2}'); background-size: 100% 100%;`;
								break;
							}
						}
						icons_heros.appendChild(icon_hero);
					}
					details_radiant.appendChild(icons_heros);

					var details = document.createElement("div");
					var plug = document.createElement("div");
					plug.style = "display: flex; flex-direction: row;";
					plug.innerHTML = `<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #79d43d; font-size: 18px; font-family: Arial, sans-serif;">Имя</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 18px; font-family: Arial, sans-serif;">у</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 18px; font-family: Arial, sans-serif;">с</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 18px; font-family: Arial, sans-serif;">п</div>` +
									 `<div style="height: 45px; width: 80px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 18px; font-family: Arial, sans-serif;">цен</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 18px; font-family: Arial, sans-serif;">ур</div>` +
							         `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">дк</div>` +
								     `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">но</div>` +
									 `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 18px; font-family: Arial, sans-serif;">оп/мин</div>` +
								     `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 18px; font-family: Arial, sans-serif;">зол/мин</div>` +
									 `<div style="height: 45px; width: 95px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">урон гер.</div>` +
								     `<div style="height: 45px; width: 85px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">лечение</div>` +
									 `<div style="height: 45px; width: 100px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">урон стро.</div>` +
									 `<div style="height: 45px; width: 336px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">предметы</div>` +
									 `<div style="height: 45px; width: 58px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; margin-left: 20px; font-family: Arial, sans-serif;">нейт</div>` +
									 `<div style="height: 45px; width: 1374px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">Прокачка способностей</div>`;
					details.appendChild(plug);
					for (val of team_radiant) {
						var val2; var ability = '';
						console.log(val['ability_upgrades_arr']);
						if (val['ability_upgrades_arr'] !== null) {
							for (val2 of val['ability_upgrades_arr']) {
								if (val2 == "730"){
									ability = ability + `<div style="height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; text-align: center; line-height: 41px; border-bottom: 1px solid #66533f; color: #fae7b4; font-size: 18px; font-family: Arial, sans-serif; background-color: #ccaf62;">+2</div>`;
								} else if (dota_ability[val2].includes("special_bonus")) {
									ability = ability + `<div style="background-image: url({{ url_for('static', filename='talant.jpg') }}); background-size: 100% 100%; height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: #704b48; border-bottom: 1px solid #66533f;" title="${dota_ability_description[dota_ability[val2]]["dname"]}"></div>`;
								} else {
									ability = ability + `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/abilities/${dota_ability[val2]}.png); background-size: 100% 100%; height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: #704b48; border-bottom: 1px solid #66533f;" title="${dota_ability_description[dota_ability[val2]]["dname"]}"></div>`;
								}

							}
							ability = '<div style="height: 37px; width: 20px; margin-top: 4px; margin-left: 4px;"></div>' + ability + '<div style="height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: #704b48; border-bottom: 1px solid #66533f;"></div>'.repeat(30 - val["ability_upgrades_arr"].length);
						} else {
							ability = '<div style="height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: 	#808080; border-bottom: 1px solid #66533f;"></div>'.repeat(30);
						}
						var player_details = document.createElement("div");
						player_details.style = "display: flex; flex-direction: row;";
						player_details.innerHTML = `<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #79d43d; font-size: 20px; font-family: Arial, sans-serif;">${val["personaname"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 20px; font-family: Arial, sans-serif;">${val["kills"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 20px; font-family: Arial, sans-serif;">${val["deaths"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 20px; font-family: Arial, sans-serif;">${val["assists"]}</div>` +
												   `<div style="height: 45px; width: 80px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 20px; font-family: Arial, sans-serif;">${val["net_worth"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 20px; font-family: Arial, sans-serif;">${val["level"]}</div>` +
												   `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["last_hits"]}</div>` +
												   `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["denies"]}</div>` +
												   `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 20px; font-family: Arial, sans-serif;">${val["xp_per_min"]}</div>` +
												   `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 20px; font-family: Arial, sans-serif;">${val["gold_per_min"]}</div>` +
												   `<div style="height: 45px; width: 95px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["hero_damage"]}</div>` +
												   `<div style="height: 45px; width: 85px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["hero_healing"]}</div>` +
												   `<div style="height: 45px; width: 100px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["tower_healing"]}</div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_0']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_1']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_2']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_3']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_4']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_5']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_neutral']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 26px; background-color: #d95757;"></div>` +
												   ability;

						details.appendChild(player_details);
					}
					details_radiant.appendChild(details);


<!--					qwadasdasdasdasdasd-->
					var details_dire = document.createElement("div");
					details_dire.id = "element";
					details_dire.style = "width: 1294px; display: flex; flex-direction: row; border: 1px solid #756537; margin-top: 20px; overflow: auto; background-color: #fadcb4;";
					var icons_heros = document.createElement("div");
					var plug = document.createElement("div");
					plug.style = "width: 80px; height: 45px; text_align: center; line-height: 45px; font-size: 20px; font-family: Arial, sans-serif; font-weight: bold; color: #FF0000; background-color: #9c5d5d";
					plug.innerHTML = "dire";
					icons_heros.appendChild(plug);
					for (val of team_dire) {
						var val_2;
						var icon_hero = document.createElement("div");
						for (val_2 of dota_heroes) {
							if (val_2['id'] == val['hero_id']) {
								val_2 = val_2['name'].substring(14);
								val_2 = 'https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/heroes/' + val_2 + '.png';
								icon_hero.style = `width: 80px; height: 45px; background-image: url('${val_2}'); background-size: 100% 100%;`;
								break;
							}
						}
						icons_heros.appendChild(icon_hero);
					}
					details_dire.appendChild(icons_heros);

					var details = document.createElement("div");
					var plug = document.createElement("div");
					plug.style = "display: flex; flex-direction: row;";
					plug.innerHTML = `<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #FF0000; font-size: 18px; font-family: Arial, sans-serif;">Имя</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 18px; font-family: Arial, sans-serif;">у</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 18px; font-family: Arial, sans-serif;">с</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 18px; font-family: Arial, sans-serif;">п</div>` +
									 `<div style="height: 45px; width: 80px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 18px; font-family: Arial, sans-serif;">цен</div>` +
									 `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 18px; font-family: Arial, sans-serif;">ур</div>` +
							         `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">дк</div>` +
								     `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">но</div>` +
									 `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 18px; font-family: Arial, sans-serif;">оп/мин</div>` +
								     `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 18px; font-family: Arial, sans-serif;">зол/мин</div>` +
									 `<div style="height: 45px; width: 95px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">урон гер.</div>` +
								     `<div style="height: 45px; width: 85px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">лечение</div>` +
									 `<div style="height: 45px; width: 100px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">урон стро.</div>` +
									 `<div style="height: 45px; width: 336px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">предметы</div>` +
									 `<div style="height: 45px; width: 58px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; margin-left: 20px; font-family: Arial, sans-serif;">нейт</div>` +
									 `<div style="height: 45px; width: 1374px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 18px; font-family: Arial, sans-serif;">Прокачка способностей</div>`;
					details.appendChild(plug);
					for (val of team_dire) {
						var val2; var ability = '';
						if (val['ability_upgrades_arr'] !== null) {
							for (val2 of val['ability_upgrades_arr']) {
								if (val2 == "730"){
									ability = ability + `<div style="height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; text-align: center; line-height: 41px; border-bottom: 1px solid #66533f; color: #fae7b4; font-size: 18px; font-family: Arial, sans-serif; background-color: #ccaf62;">+2</div>`;
								} else if (dota_ability[val2].includes("special_bonus")) {
									ability = ability + `<div style="background-image: url({{ url_for('static', filename='talant.jpg') }}); background-size: 100% 100%; height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: #704b48; border-bottom: 1px solid #66533f;" title="${dota_ability_description[dota_ability[val2]]["dname"]}"></div>`;
								} else {
									ability = ability + `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/abilities/${dota_ability[val2]}.png); background-size: 100% 100%; height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: #704b48; border-bottom: 1px solid #66533f;" title="${dota_ability_description[dota_ability[val2]]["dname"]}"></div>`;
								}
							}
							ability = '<div style="height: 37px; width: 20px; margin-top: 4px; margin-left: 4px;"></div>' + ability + '<div style="height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: #704b48; border-bottom: 1px solid #66533f;"></div>'.repeat(30 - val["ability_upgrades_arr"].length);
						} else {
							ability = '<div style="height: 37px; width: 41px; margin-top: 4px; margin-left: 4px; background-color: 	#808080; border-bottom: 1px solid #66533f;"></div>'.repeat(30);
						}

						var player_details = document.createElement("div");
						player_details.style = "display: flex; flex-direction: row;";
						player_details.innerHTML = `<div style="height: 45px; width: 200px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #FF0000; font-size: 20px; font-family: Arial, sans-serif;">${val["personaname"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 20px; font-family: Arial, sans-serif;">${val["kills"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 20px; font-family: Arial, sans-serif;">${val["deaths"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: rgb(128, 105, 80); font-size: 20px; font-family: Arial, sans-serif;">${val["assists"]}</div>` +
												   `<div style="height: 45px; width: 80px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 20px; font-family: Arial, sans-serif;">${val["net_worth"]}</div>` +
												   `<div style="height: 45px; width: 45px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 20px; font-family: Arial, sans-serif;">${val["level"]}</div>` +
												   `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["last_hits"]}</div>` +
												   `<div style="height: 45px; width: 53px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["denies"]}</div>` +
												   `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #008080; font-size: 20px; font-family: Arial, sans-serif;">${val["xp_per_min"]}</div>` +
												   `<div style="height: 45px; width: 70px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #d9d921; font-size: 20px; font-family: Arial, sans-serif;">${val["gold_per_min"]}</div>` +
												   `<div style="height: 45px; width: 95px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["hero_damage"]}</div>` +
												   `<div style="height: 45px; width: 85px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["hero_healing"]}</div>` +
												   `<div style="height: 45px; width: 100px; text-align: center; line-height: 45px; border-bottom: 1px solid #66533f; color: #4a4242; font-size: 20px; font-family: Arial, sans-serif;">${val["tower_healing"]}</div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_0']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_1']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_2']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_3']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_4']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_5']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 4px; background-color: #d95757; border-bottom: 1px solid #66533f;"></div>` +
												   `<div style="background-image: url(https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${dota_items[val['item_neutral']]}.png); background-size: 100% 100%; height: 37px; width: 52px; margin-top: 4px; margin-left: 26px; background-color: #d95757;"></div>` +
												   ability;

						details.appendChild(player_details);
					}
					details_dire.appendChild(details);
					results_header.appendChild(players_radiant);
					results_header.appendChild(canvas);
					results_header.appendChild(players_dire);


					if (data["radiant_win"]) {
						var before_header = document.createElement('div');
						before_header.style = 'width: 100%; height: 60px; position: relative; display: flex; flex-direction: row;';
						before_header.innerHTML = '<div style="background: linear-gradient(to right, #79d43d, #fae7b4); width: 400px; height: 60px; display: flex; justify-content: flex-start; align-items: center; padding-left: 50px;"><h1 style="font-size: 30px; font-family: Arial, sans-serif; font-weight: bold; color: #79d43d; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4); ">Radiant Win</h1></div>' +
												  `<div style="position: absolute; left: 50%; transform: translate(-50%, 0%); width: 270px; height: 60px;"><div style="width: 100%; height: 30px; color: rgb(128, 105, 80); font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; line-height: 30px;">Матч id - ${data["match_id"]}</div><div style="display: flex; flex-direction: row; width: 270px; height: 30px;"><div style="width: 130px; height: 30px; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;"><span style="color: #79d43d; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">${data["radiant_score"]}</span>:<span style="color: red; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">${data["dire_score"]}</span></div><div style="width: 130px; height: 30px; color: #806950; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">${formatTime(data["duration"])}</div></div>`;

					} else {
						var before_header = document.createElement('div');
						before_header.style = 'width: 100%; height: 60px; position: relative; display: flex; flex-direction: row;';
						before_header.innerHTML = '<div style="background: linear-gradient(to left, #ff0000, #fae7b4); width: 400px; height: 60px; display: flex; justify-content: flex-end; align-items: center; padding-right: 50px; margin-left: auto;"><h1 style="font-size: 30px; font-family: Arial, sans-serif; font-weight: bold; color: #ff0000; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);">Dire Win<h1></div>' +
												  `<div style="position: absolute; left: 50%; transform: translate(-50%, 0%); width: 270px; height: 60px;"><div style="width: 100%; height: 30px; color: rgb(128, 105, 80); font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; text-align: center; line-height: 30px;">Матч id - ${data["match_id"]}</div><div style="display: flex; flex-direction: row; width: 270px; height: 30px;"><div style="width: 130px; height: 30px; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;"><span style="color: #79d43d; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">${data["radiant_score"]}</span>:<span style="color: red; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">${data["dire_score"]}</span></div><div style="width: 130px; height: 30px; color: #806950; font-family: Arial, sans-serif; font-size: 20px; text-align: center; line-height: 30px;">${formatTime(data["duration"])}</div></div>`;
					}

					const date = new Date(data['start_time'] * 1000).toUTCString();

					var dota_game_mode = await fetch("https://api.opendota.com/api/constants/game_mode");
					var dota_game_mode = await dota_game_mode.json();

					var dota_lobby_type = await fetch("https://api.opendota.com/api/constants/lobby_type");
					var dota_lobby_type = await dota_lobby_type.json();

					var match_information = document.createElement("div");
					match_information.style = "display: flex; flex-direction: row; width: 100%; margin-top: 14px;";
					match_information.innerHTML = `<div style="width: 25%; height: 60px;"><div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${date}</div><div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">начало матча</div></div>` +
												  `<div style="width: 25%; height: 60px;"><div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${dota_game_mode[data['game_mode']]['name'].substring(10)}</div><div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Режим игры</div></div>` +
												  `<div style="width: 25%; height: 60px;"><div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${dota_lobby_type[data['lobby_type']]['name'].substring(11)}</div><div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">тип лобби</div></div>` +
												  `<div style="width: 25%; height: 60px;"><div style="width: 100%; height: 40px; font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; line-height: 40px; color: #665440">${formatTime(data['first_blood_time'])}</div><div style="width: 100%; height: 20px; font-famil: Arial, sans-serif; font-size: 15px; font-weight: bold; line-height: 20px; color: #a38767">Первая кровь</div></div>`;


					results.appendChild(before_header);
					results.appendChild(results_header);
					results.appendChild(match_information);
					results.appendChild(details_radiant);
					results.appendChild(details_dire);
				}
			}


			document.addEventListener("keyup", function(event) {
			  if (event.code === "Enter") {
				if (document.activeElement == input_match) {
					search_for_match_by_matchid();
				} else if (document.activeElement == input_player){
					search_for_steamid_by_nickname();
				}
			  }
			});


			async function search_for_steamid_by_nickname() {
			  var player_name = input_player.value;
			  results.innerHTML = '';
			  results.style['margin-top'] = (bar_search.scrollHeight) + 'px';

			  if (player_name.length != '0') {
				  const url = `https://api.opendota.com/api/search?q=${player_name}`;
				  const response = await fetch(url);
				  const data = await response.json();
				  if (data.length != '0') {
					  var val;
					  for (val of data) {
						  var item = document.createElement("div");
						  item.style = 'background-color: #806950; border: 5px solid #66533f; border-radius: 9px; font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; margin-top: 7px; display: flex; justify-content: space-between; align-items: center;';
						  item.innerHTML = `<img src="${val["avatarfull"]}" alt="alt" style="padding: 15px; width: 110px; height: 110px; text-align: center;"><button onclick="one_player('${val['account_id']}')" style="padding: 15px; text-align: center; margin-left: auto; margin-right: auto; background-color: #806950; font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; border: none;">${val["personaname"]}</button>`;
						  results.append(item);
					  }
				  } else {
					  var error = document.createElement("div");
					  error.style = 'background-color: #806950; border: 5px solid #66533f; border-radius: 9px; font-family: Arial, sans-serif; font-size: 24px; color: #fae7b4; margin-top: 7px; display: flex; justify-content: space-between; align-items: center;';
					  error.innerHTML = 'Ничего не найдено';
					  results.append(error);
				  }

			  } else {
					true;
			  }
			}

			function click_button_match() {
				if (!animation & input_match.style["display"] == "none" & input_player.style["display"] == "none") {
					input_match.style["display"] = "block";
					icon_match.style["display"] = "block";
					button_match.style["border-radius"] = "5px 0px 0px 5px";
					animation = true;

					var width = 20;
					var id = setInterval(frame, 1);

					function frame() {
						if (width >= 100) {
							animation = false;
							input_match.focus();
							clearInterval(id);
						}
						else {
							width++;
							bar_match.style["width"] = width + '%';
						}
					}

				} else if (!animation & input_match.style["display"] != "none" & input_player.style["display"] == "none") {
					animation = true;

					var width = 100;
					var id = setInterval(frame, 1);

					function frame() {
						if (width <= 20) {
							animation = false;
							clearInterval(id);
							input_match.style["display"] = "none";
							icon_match.style["display"] = "none";
							button_match.style["border-radius"] = "5px 5px 5px 5px";
							bar_match.style["width"] = "auto";
						} else {
							width--;
							bar_match.style["width"] = width + '%';
						}
					}

				} else if (!animation & input_match.style["display"] == "none" & input_player.style["display"] != "none") {
					animation = true;

					input_match.style["display"] = "block";
					icon_match.style["display"] = "block";
					button_match.style["border-radius"] = "5px 0px 0px 5px";

					var width = 20;
					var id = setInterval(frame, 1);

					var width2 = 100;
					var id2 = setInterval(frame2, 1);

					function frame() {
						if (width >= 100) {
							animation = false;
							input_match.focus();
							clearInterval(id);
						}
						else {
							width++;
							bar_match.style["width"] = width + '%';
						}
					}

					function frame2() {
						if (width2 <= 20) {
							animation = false;
							clearInterval(id2);
							input_player.style["display"] = "none";
							icon_player.style["display"] = "none";
							button_player.style["border-radius"] = "5px 5px 5px 5px";
							bar_player.style["width"] = "auto";
						} else {
							width2--;
							bar_player.style["width"] = width2 + '%';
						}
					}


				}
			}

			function click_button_player() {
				if (!animation & input_match.style["display"] == "none" & input_player.style["display"] == "none") {
					input_player.style["display"] = "block";
					icon_player.style["display"] = "block";
					button_player.style["border-radius"] = "5px 0px 0px 5px";
					animation = true;

					var width = 20;
					var id = setInterval(frame, 1);

					function frame() {
						if (width >= 100) {
							animation = false;
							input_player.focus();
							clearInterval(id);
						}
						else {
							width++;
							bar_player.style["width"] = width + '%';
						}
					}

				} else if (!animation & input_match.style["display"] == "none" & input_player.style["display"] != "none") {
					animation = true;

					var width = 100;
					var id = setInterval(frame, 1);

					function frame() {
						if (width <= 20) {
							animation = false;
							clearInterval(id);
							input_player.style["display"] = "none";
							icon_player.style["display"] = "none";
							button_player.style["border-radius"] = "5px 5px 5px 5px";
							bar_player.style["width"] = "auto";
						} else {
							width--;
							bar_player.style["width"] = width + '%';
						}
					}

				} else if (!animation & input_match.style["display"] != "none" & input_player.style["display"] == "none") {
					animation = true;

					input_player.style["display"] = "block";
					icon_player.style["display"] = "block";
					button_player.style["border-radius"] = "5px 0px 0px 5px";

					var width = 20;
					var id = setInterval(frame, 1);

					var width2 = 100;
					var id2 = setInterval(frame2, 1);

					function frame() {
						if (width >= 100) {
							animation = false;
							input_player.focus();
							clearInterval(id);
						}
						else {
							width++;
							bar_player.style["width"] = width + '%';
						}
					}

					function frame2() {
						if (width2 <= 20) {
							animation = false;
							clearInterval(id2);
							input_match.style["display"] = "none";
							icon_match.style["display"] = "none";
							button_match.style["border-radius"] = "5px 5px 5px 5px";
							bar_match.style["width"] = "auto";
						} else {
							width2--;
							bar_match.style["width"] = width2 + '%';
						}
					}
				}
			}
		</script>
	</body>
</html>
